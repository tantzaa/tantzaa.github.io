<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="styles2.css">
    <title>JSON</title>
</head>

<!--Navigaatio-->
<body class="bg-light">
    <nav class="navbar navbar-expand-md navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">JSON</a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="index.html">Etusivu (Tehtävä 1 OSA I)</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="toteutus.html">Tehtävä 1 OSA II</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="poke.html">Poke haku (Tehtävä 2 OSA I ja II)</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="saa.html">Tehtävä 3</a>
                    </li>
                </ul>
            </div>

        </div>
    </nav>

    <div id="vastaus"></div>

    <script>
        //Säätietojen haku JSON:in avulla
        function haeSaatiedot() {
            fetch("https://api.openweathermap.org/data/2.5/weather?id=658225&appid=665ecd56dfc08dbb50feb8b8f5034e28&lang=fi&units=metric")


                .then(function (response) {
                    return response.json();
                })
                .then(function (json) {
                    listaaSaatiedot(json);
                })
                .catch(function (error) {
                    document.getElementById("vastaus").innerHTML = "Tietoja ei voitu hakea";
                    console.error("Virhe:", error);
                });
        }

        function listaaSaatiedot(saatiedot) {
            // Haetaan säätiedot
            let kuvaus = saatiedot.weather[0].description;
            let lampotila = saatiedot.main.temp;
            let tuuli = saatiedot.wind.speed;
            let ikoni = saatiedot.weather[0].icon;
            let ikoniUrl = "https://openweathermap.org/img/wn/" + ikoni + "@2x.png";

            // Haetaan nykyinen kellonaika
            let nyt = new Date();
            let tunnit = nyt.getHours().toString().padStart(2, "0");
            let minuutit = nyt.getMinutes().toString().padStart(2, "0");
            let aika = tunnit + "." + minuutit;

            // Rakennetaan HTML-sisältö
            let teksti = "<h1>Sää Helsingissä</h1>";
            teksti += "Sää kello "  + aika;
            teksti += "<p><strong>Säätila:</strong> " + kuvaus + "</p>";
            teksti += "<p><strong>Lämpötila:</strong> " + lampotila + " °C</p>";
            teksti += "<p><strong>Tuuli:</strong> " + tuuli + " m/s</p>";
            teksti += "<img src='" + ikoniUrl + "' alt='Sääkuvake'>";

            // Näytetään sisältö sivulla
            document.getElementById("vastaus").innerHTML = teksti;
        }



        haeSaatiedot();
    </script>
</body>

</html>